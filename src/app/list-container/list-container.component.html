<form class="list-container__form" novalidate [formGroup]="inputForm" (ngSubmit)="addItem()">
  <mat-form-field class="list-container__input" floatLabel="never">
    <input
      matInput
      type="text"
      formControlName="inputControl"
      required
      placeholder="Lisa nimekirja"
      [matAutocomplete]="auto"
      [errorStateMatcher]="inputValid"
    />
    <mat-autocomplete #auto="matAutocomplete" [displayWith]="inputDisplay" (optionSelected)="addItem()">
      <mat-option
        [innerHTML]="item.displayName"
        *ngFor="let item of filteredItems$ | async; trackBy: trackById"
        [value]="item"
      >
      </mat-option>
    </mat-autocomplete>
  </mat-form-field>
  <button mat-raised-button type="submit" color="primary" [disabled]="!inputForm.valid">Lisa</button>
</form>
<mat-divider></mat-divider>
<mat-list
  cdkDropList
  (cdkDropListDropped)="dropGroup($event)"
  class="lists-container__item-list"
  [disableRipple]="false"
  *ngIf="groupsWithItems$ | async as groups"
  [cdkDropListData]="groups"
>
  <div
    class="list-container__group"
    *ngFor="let group of groups; first as isFirst; trackBy: trackById"
    cdkDragLockAxis="y"
    cdkDrag
    [cdkDragData]="group"
    [cdkDragStartDelay]="1000"
  >
    <div
      id="{{ group.id }}"
      cdkDropList
      cdkDropListSortingDisabled
      *ngIf="group.active"
      [cdkDropListConnectedTo]="getConnectedGroups(group.id, groups)"
      [cdkDropListData]="group.id"
      (cdkDropListDropped)="drop($event)"
    >

      <h3 matSubheader>{{ group.name }}</h3>
      <ng-container *ngIf="group.active">
        <mat-list-item
          [cdkDragData]="item"
          *ngFor="let item of group.items; trackBy: trackById"
          cdkDragLockAxis="y"
          cdkDrag
          [cdkDragStartDelay]="1000"
        >
          <mat-checkbox (click)="markDone(item)">{{ item.name }}</mat-checkbox>
          <span class="space"></span>
          <button mat-icon-button [routerLink]="['/home/item', listId | async, item.id]">
            <mat-icon>edit</mat-icon>
          </button>
        </mat-list-item>
      </ng-container>
      <mat-divider></mat-divider>
    </div>
  </div>
</mat-list>
